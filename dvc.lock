schema: '2.0'
stages:
  video_learning:
    cmd: python video_pipeline/learning.py
    deps:
    - path: data/video/test_signal
      md5: 1b6a0245e6f042ed37cd4ef8d60e4744.dir
      size: 39770868
      nfiles: 1024
    - path: data/video/train_signal
      md5: 43e032058bace4dc5965fd81b79ec3af.dir
      size: 362455475
      nfiles: 11136
    params:
      params.yaml:
        video_train:
          batch_size: 1000
          learning_rate: 0.0001
          epochs: 120
          model_name: ParamStackNetSingle
          layers:
          - - 300
            - 100
          - - 500
            - 200
            - 200
            - 500
          frames_number: 3
          frames_interval: 1
    outs:
    - path: data/v_model
      md5: 3d4e100a93299f5d0ad3c75a85d9a1a7.dir
      size: 4054267
      nfiles: 1
    - path: reports/full_test_loss.csv
      md5: 1aeaf1f4d19c64aeb69ca5da16cd39c3
      size: 2518
    - path: reports/full_train_loss.csv
      md5: a14297f546c7f8151ddf3ede99fe7fc5
      size: 2540
    - path: reports/v_summary.json
      md5: 54d235a91ef355081415d124f84a6850
      size: 81
  video_sim:
    cmd: python video_pipeline/video_sim_runner.py
    deps:
    - path: data/video/pressure
      md5: dc81e8ebfc1f5451f5f281e1bb761a14.dir
      size: 1306820838
      nfiles: 2
    - path: video_pipeline/video_sim_runner.py
      md5: 8d6f19b99a7cd92f44337c9f107e8557
      size: 2242
    params:
      params.yaml:
        env.phys.gaus_kernel_size: 3
        env.phys.kof: 15
        env.sen_geometry.n_angles: 4
    outs:
    - path: data/video/signal
      md5: 6e8b8e1c7f98b9c5701f23187b0f5ce3.dir
      size: 299262472
      nfiles: 2
  visual:
    cmd: python video_pipeline/prediction_visualization.py
    deps:
    - path: data/v_model
      md5: 3d4e100a93299f5d0ad3c75a85d9a1a7.dir
      size: 4054267
      nfiles: 1
    params:
      params.yaml:
        visual:
          test:
            step: 32
            max_items: 128
          train:
            step: 32
            max_items: 32
    outs:
    - path: data/video/predict_vis
      md5: 414ab7480552fd5ab5057640668d5c98.dir
      size: 20138405
      nfiles: 65
  push_logs:
    cmd: python csv_logger.py
