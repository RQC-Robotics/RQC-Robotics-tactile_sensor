stages:
  simulate:
    cmd: python dvc_sim_runner.py
    
    params:
      - dataset.signal_path
      - dataset.pic_path
      - random_seed
      - env.sen_geometry
      - env.phys
      - sim
    deps:
      - dvc_sim_runner.py
      - data/pressure/pic  
    outs:
      - data/sensor_signal

  learning:
    cmd: python dvc_model_learning.py

    params:
      - train

    deps:
      - data/sensor_signal
      - data/pressure/pic  
      - dvc_model_learning.py
    outs:
      - data/model
      
    plots:
      - reports/learning_curve.csv:
          cache: false

    metrics:
      - reports/summary.json:
          cache: false

  evaluate:
    cmd: python dvc_evaluate_model.py

    deps:
    - data/model

    outs:
    - reports/report.md:
        cache: false
    - reports/l_curve.png:
        cache: false
    - reports/predict_examples.png:
        cache: false

  make_plot:
    cmd: dvc plots show reports/learning_curve.csv --x-label "epochs" --y-label "loss"

    outs:
    - dvc_plots/index.html:
        cache: false

